<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>M√°quina de Cart√£o - Belly</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#ff5fb3">
<link rel="icon" href="favicon.ico" type="image/x-icon">

<style>
* { box-sizing: border-box; }

body {
    background: linear-gradient(135deg, #ffb6e6, #c77dff);
    min-height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    font-family: "Comic Sans MS", Arial, sans-serif;
    padding: 10px;
}

.machine {
    width: 100%;
    max-width: 340px;
    background: linear-gradient(180deg, #ffffff, #ffe6f7);
    border-radius: 30px;
    padding: 20px;
    box-shadow: 0 20px 40px rgba(0,0,0,0.3);
    position: relative;
    border: 4px solid #ff7ac8;
}

.screen {
    background: linear-gradient(180deg, #ff92d0, #ff5fb3);
    color: #ffffff;
    min-height: 120px;
    border-radius: 15px;
    padding: 12px;
    margin-bottom: 15px;
    display: flex;
    flex-direction: column;
    justify-content: center;
}

.brand {
    text-align: center;
    color: #4a0033;
    font-weight: bold;
    font-size: 14px;
}

.brand span { font-size: 18px; }

#message { text-align: center; margin: 5px 0; }

.value {
    font-size: 24px;
    text-align: right;
    font-weight: bold;
}

.keyboard {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 10px;
}

button {
    height: 55px;
    border-radius: 15px;
    border: none;
    font-size: 18px;
    cursor: pointer;
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
}

.num {
    background: #ffb6e6;
    font-weight: bold;
}

.ok {
    background: linear-gradient(135deg, #6dff8f, #2ecc71);
    font-size: 20px;
}

.cancel {
    background: linear-gradient(135deg, #ff7a7a, #e74c3c);
    color: #fff;
}

.clear {
    background: linear-gradient(135deg, #fff1a8, #f1c40f);
}

.history-btn {
    margin-top: 12px;
    width: 100%;
    height: 48px;
    background: linear-gradient(135deg, #8fd3ff, #3498db);
    color: #fff;
    font-weight: bold;
    border-radius: 15px;
}

/* Hist√≥rico */
.history {
    position: fixed; /* alterado para garantir visibilidade */
    inset: 0;
    background: linear-gradient(180deg, #ffb6e6, #c77dff);
    border-radius: 30px;
    padding: 20px;
    display: none;
    flex-direction: column;
    color: #fff;
    z-index: 999;
}

.history ul {
    list-style: none;
    overflow-y: auto;
    flex: 1;
    padding: 0;
    background: rgba(255,255,255,0.2);
    border-radius: 15px;
}

.history li {
    padding: 8px;
    border-bottom: 1px dashed rgba(255,255,255,0.5);
}

.close-history {
    margin-top: 10px;
    height: 45px;
    border-radius: 15px;
    background: linear-gradient(135deg, #ff7a7a, #e74c3c);
    color: #fff;
    font-weight: bold;
}

/* TOTAL */
#totalValue {
    margin-top: 10px;
    padding: 10px;
    background: rgba(255,255,255,0.25);
    border-radius: 15px;
    text-align: center;
    font-weight: bold;
}

/* CORA√á√ïES */
.heart {
    position: fixed;
    bottom: 0;
    font-size: 24px;
    animation: floatUp 3s linear forwards;
    pointer-events: none;
    z-index: 9999;
}

@keyframes floatUp {
    to {
        transform: translateY(-100vh) scale(1.8);
        opacity: 0;
    }
}

/* TELA CHEIA MOBILE */
@media (max-width: 600px) {
    body { padding: 0; }
    .machine {
        width: 100vw;
        height: 100vh;
        max-width: none;
        border-radius: 0;
        border: none;
    }
    .history { border-radius: 0; }
}

/* Bot√µes de servi√ßo */
.service-btn {
    background: linear-gradient(135deg, #ffe6f0, #ffb6e6);
    border: none;
    border-radius: 15px;
    padding: 5px;
    cursor: pointer;
    display: flex;
    flex-direction: column;
    align-items: center;
    font-weight: bold;
    font-size: 14px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    transition: transform 0.2s;
}

.service-btn:hover {
    transform: scale(1.1);
}

/* Tela de introdu√ß√£o full screen */
#intro {
    position: fixed;
    inset: 0;
    background: #000; /* fundo preto enquanto o v√≠deo carrega */
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 9999;
    flex-direction: column;
    overflow: hidden;
}

#intro video {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 100%;
    height: 100%;
    object-fit: cover; /* cobre toda a tela sem distorcer */
    transform: translate(-50%, -50%);
    z-index: 1;
}

#skipBtn {
    position: relative;
    z-index: 2; /* acima do v√≠deo */
    margin-top: 20px;
    padding: 10px 20px;
    font-size: 16px;
    border: none;
    border-radius: 10px;
    background: #ff5fb3;
    color: #fff;
    cursor: pointer;
}

.score-container {
    position: absolute;
    top: 12px;
    right: 12px;
    z-index: 10;

    font-size: 18px;
    font-weight: bold;

    background: rgba(255,255,255,0.85);
    padding: 6px 12px;
    border-radius: 20px;
    color: #ff5fb3;

    box-shadow: 0 4px 8px rgba(0,0,0,0.25);
}
.clear-history {
    margin-top: 10px;
    height: 45px;
    border-radius: 15px;
    background: linear-gradient(135deg, #ffb347, #ff9800);
    color: #fff;
    font-weight: bold;
    font-size: 16px;
    border: none;
    cursor: pointer;
    box-shadow: 0 4px 8px rgba(0,0,0,0.3);
}

</style>
</head>

<body>
<!-- Tela de introdu√ß√£o -->
<div id="intro">
    <video id="introVideo" autoplay muted playsinline>
        <source src="intro.mp4" type="video/mp4">
        Seu navegador n√£o suporta v√≠deo.
    </video>
</div>


<div class="machine">
    <div class="score-container" id="scoreDisplay">
        ‚≠ê <span id="scoreValue">0</span>
    </div>

    <div class="screen">
        <div class="brand">üíñ <span>BELLY</span> üíá‚Äç‚ôÄÔ∏èüíâ<br>Tattoo & Cabeleleira</div>
        <div id="message">‚ú® Digite o valor ‚ú®</div>
        <div class="value" id="value">R$ 0,00</div>
    </div>

    <div class="keyboard">
        <button class="num" onclick="addNumber(1)">1</button>
        <button class="num" onclick="addNumber(2)">2</button>
        <button class="num" onclick="addNumber(3)">3</button>
        <button class="num" onclick="addNumber(4)">4</button>
        <button class="num" onclick="addNumber(5)">5</button>
        <button class="num" onclick="addNumber(6)">6</button>
        <button class="num" onclick="addNumber(7)">7</button>
        <button class="num" onclick="addNumber(8)">8</button>
        <button class="num" onclick="addNumber(9)">9</button>
        <button class="clear" onclick="clearValue()">üßπ</button>
        <button class="num" onclick="addNumber(0)">0</button>
        <button class="cancel" onclick="cancel()">‚ùå</button>
        <button class="ok" style="grid-column:span 3" onclick="pay()">üí≥ PAGAR üíñ</button>
    </div>


    <button class="history-btn" onclick="openHistory()">üìú HIST√ìRICO</button>

    <div class="history" id="history">
        <h3 style="text-align:center;">üíñ Hist√≥rico üíñ</h3>
        <ul id="historyList"></ul>
        <div id="totalValue">üí∞ Total: R$ 0,00</div>
        <button class="clear-history" onclick="openClearPopup()">
            üóëÔ∏è APAGAR HIST√ìRICO
        </button>
        <button class="close-history" onclick="closeHistory()">‚¨Ö VOLTAR</button>
    </div>

        <div class="service-selection" style="display:flex; justify-content:space-around; margin-top:15px;">
        <button class="service-btn" onclick="selectService('Tattoo')">
            <img src="https://cdn-icons-png.flaticon.com/512/3565/3565457.png" alt="Tattoo" style="width:40px; height:60px;">
            <div>Tattoo</div>
        </button>

        <button class="service-btn" onclick="selectService('Cabeleireira')">
            <img src="https://cdn-icons-png.flaticon.com/512/2921/2921822.png" alt="Cabeleireira" style="width:40px; height:60px;">
            <div>Cabeleireira</div>
        </button>
    </div>

</div>

<!-- SOM -->
<audio id="successSound">
    <source src="success.wav" type="audio/mpeg">
</audio>

<script>
let amount = "";
let history = [];
try {
    history = JSON.parse(localStorage.getItem("bellyHistory")) || [];
} catch {
    history = [];
}

let selectedService = "";
let clientName = "";
let score = parseInt(localStorage.getItem("bellyScore")) || 0;


function updateScore() {
    document.getElementById("scoreValue").innerText = score;
    localStorage.setItem("bellyScore", score);
}

window.addEventListener("load", updateScore);

function addNumber(num) {
    amount += num;
    updateDisplay();
}

function updateDisplay() {
    let value = parseFloat(amount || 0) / 100;
    document.getElementById("value").innerText =
        value.toLocaleString("pt-BR",{style:"currency",currency:"BRL"});
}

function clearValue() {
    amount="";
    document.getElementById("message").innerText="‚ú® Digite o valor ‚ú®";
    updateDisplay();
}

function cancel() {
    amount="";
    document.getElementById("message").innerText="‚ùå Cancelado";
    updateDisplay();
}

function selectService(service) {
    selectedService = service;
    document.getElementById("message").innerText = `‚ú® Servi√ßo selecionado: ${service} ‚ú®`;
}

function pay() {
    if (!amount) return;
    if (!selectedService) {
        document.getElementById("message").innerText = "‚ùå Escolha um servi√ßo antes de pagar!";
        return;
    }

    document.getElementById("clientPopup").style.display = "flex";
}
function confirmClientName() {
    const input = document.getElementById("clientNameInput");
    clientName = input.value.trim();

    if (!clientName) {
        alert("Digite o nome do cliente üíñ");
        return;
    }

    let valueNumber = parseFloat(amount) / 100;

    history.push({
        client: clientName,
        service: selectedService,
        value: valueNumber,
        date: new Date().toLocaleString("pt-BR")
    });

    updateHistory();

    score++;
    updateScore();

    document.getElementById("message").innerText =
        `üíñ Pagamento aprovado! ${clientName} ‚Ä¢ ${selectedService}`;

    document.getElementById("successSound").play();
    heartsEffect();

    amount = "";
    selectedService = "";
    clientName = "";
    input.value = "";

    document.getElementById("clientPopup").style.display = "none";
    updateDisplay();
}

function openClearPopup() {
    document.getElementById("clearPopup").style.display = "flex";
}

function closeClearPopup() {
    document.getElementById("clearPopup").style.display = "none";
}

function confirmClearHistory() {
    history = [];
    score = 0;

    localStorage.removeItem("bellyHistory");
    localStorage.removeItem("bellyScore");

    updateHistory();
    updateScore();

    closeClearPopup();
}



function updateHistory() {
    let list = document.getElementById("historyList");
    let total = 0;
    list.innerHTML = "";

    let sections = {
        "Tattoo": {},
        "Cabeleireira": {}
    };

    // Agrupar por servi√ßo e cliente
    history.forEach(item => {
        total += item.value;

        if (!sections[item.service]) {
            sections[item.service] = {};
        }

        if (!sections[item.service][item.client]) {
            sections[item.service][item.client] = 0;
        }

        sections[item.service][item.client] += item.value;
    });

    // Renderizar se√ß√µes
    Object.keys(sections).forEach(service => {
        const clients = sections[service];
        if (Object.keys(clients).length === 0) return;

        // T√≠tulo da se√ß√£o
        let title = document.createElement("li");
        title.style.fontWeight = "bold";
        title.style.textAlign = "center";
        title.style.background = "rgba(255,255,255,0.25)";
        title.style.borderRadius = "10px";
        title.style.marginTop = "10px";
        title.textContent = service === "Tattoo" ? "üíâ TATTOO" : "üíá‚Äç‚ôÄÔ∏è CABELEIREIRA";
        list.appendChild(title);

        // Clientes da se√ß√£o
        Object.keys(clients).forEach(client => {
            let li = document.createElement("li");
            li.textContent = `üéÄ ${client} ‚Ä¢ ${clients[client].toLocaleString("pt-BR", {
                style: "currency",
                currency: "BRL"
            })}`;
            list.appendChild(li);
        });
    });

    document.getElementById("totalValue").innerText =
        "üí∞ Total: " + total.toLocaleString("pt-BR", {
            style: "currency",
            currency: "BRL"
        });

    localStorage.setItem("bellyHistory", JSON.stringify(history));
}



function heartsEffect() {
    for(let i=0;i<12;i++){
        let h=document.createElement("div");
        h.className="heart";
        h.innerHTML="üíñ";
        h.style.left=Math.random()*100+"vw";
        document.body.appendChild(h);
        setTimeout(()=>h.remove(),3000);
    }
}

function openHistory() {
    try {
        history = JSON.parse(localStorage.getItem("bellyHistory")) || [];
    } catch {
        history = [];
    }

    updateHistory();
    document.getElementById("history").style.display = "flex";
}


function closeHistory() {
    document.getElementById("history").style.display = "none";
}

if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("service-worker.js");
}
</script>
<script>
const intro = document.getElementById('intro');
const video = document.getElementById('introVideo');
const skipBtn = document.getElementById('skipBtn');
const machine = document.querySelector('.machine');

// Esconde a m√°quina enquanto o v√≠deo toca
machine.style.display = 'none';

// Quando o v√≠deo termina, mostra a m√°quina
video.addEventListener('ended', () => {
    intro.style.display = 'none';
    machine.style.display = 'block';
});

// Pular v√≠deo
skipBtn.addEventListener('click', () => {
    video.pause();
    intro.style.display = 'none';
    machine.style.display = 'block';
});

window.addEventListener("load", () => {
    updateHistory();
    updateScore();
});


</script>

<div id="clientPopup" style="
    display:none;
    position:fixed;
    inset:0;
    background:rgba(0,0,0,0.7);
    z-index:9999;
    justify-content:center;
    align-items:center;
">
    <div style="
        background:linear-gradient(180deg,#ff92d0,#ff5fb3);
        padding:20px;
        border-radius:20px;
        width:90%;
        max-width:300px;
        text-align:center;
        color:#fff;
    ">
        <h3>üéÆ Nome do Cliente</h3>
        <input id="clientNameInput" placeholder="Digite o nome üíñ"
        style="
            width:100%;
            padding:10px;
            border-radius:10px;
            border:none;
            margin:10px 0;
            font-size:16px;
        ">
        <button onclick="confirmClientName()" style="
            width:100%;
            padding:10px;
            border:none;
            border-radius:10px;
            background:#6dff8f;
            font-size:18px;
            font-weight:bold;
        ">CONFIRMAR ‚ú®</button>
    </div>
</div>
<div id="clearPopup" style="
    display:none;
    position:fixed;
    inset:0;
    background:rgba(0,0,0,0.7);
    z-index:9999;
    justify-content:center;
    align-items:center;
">
    <div style="
        background:linear-gradient(180deg,#ff92d0,#ff5fb3);
        padding:20px;
        border-radius:20px;
        width:90%;
        max-width:320px;
        text-align:center;
        color:#fff;
        box-shadow:0 10px 25px rgba(0,0,0,0.4);
    ">
        <h3>üóëÔ∏è Apagar Hist√≥rico</h3>
        <p style="font-size:14px;">
            Isso vai apagar todos os pagamentos<br>
            e zerar as ‚≠ê estrelas.
        </p>

        <button onclick="confirmClearHistory()" style="
            width:100%;
            padding:10px;
            margin-top:10px;
            border:none;
            border-radius:10px;
            background:#ff4d6d;
            color:#fff;
            font-size:16px;
            font-weight:bold;
        ">SIM, APAGAR</button>

        <button onclick="closeClearPopup()" style="
            width:100%;
            padding:10px;
            margin-top:8px;
            border:none;
            border-radius:10px;
            background:#ffe6f0;
            color:#ff5fb3;
            font-size:15px;
            font-weight:bold;
        ">CANCELAR</button>
    </div>
</div>


</body>
</html>
